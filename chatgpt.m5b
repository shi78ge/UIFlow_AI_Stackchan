{"category":"ChatGPT","color":"#19b3b0","blocks":["__ChatGPT_send_prompt","__ChatGPT_get_response"],"jscode":"// Block __ChatGPT_send_prompt\nvar __ChatGPT_send_prompt_json = {\n    \"previousStatement\": null,\n    \"nextStatement\": null,\n    \"message0\": \"%1\",\n    \"args0\": [\n        {\n            \"type\": \"field_label\",\n            \"text\": \"send_prompt\"\n        }\n    ],\n    \"message1\": \"%1 %2\",\n    \"args1\": [\n        {\n            \"type\": \"field_label\",\n            \"text\": \"openai_api_key\"\n        },\n        {\n            \"type\": \"input_value\",\n            \"name\": \"openai_api_key\"\n        }\n    ],\n    \"message2\": \"%1 %2\",\n    \"args2\": [\n        {\n            \"type\": \"field_label\",\n            \"text\": \"prompt\"\n        },\n        {\n            \"type\": \"input_value\",\n            \"name\": \"prompt\"\n        }\n    ],\n    \"message3\": \"%1 %2\",\n    \"args3\": [\n        {\n            \"type\": \"field_label\",\n            \"text\": \"role1\"\n        },\n        {\n            \"type\": \"input_value\",\n            \"name\": \"role1\"\n        }\n    ],\n    \"message4\": \"%1 %2\",\n    \"args4\": [\n        {\n            \"type\": \"field_label\",\n            \"text\": \"role2\"\n        },\n        {\n            \"type\": \"input_value\",\n            \"name\": \"role2\"\n        }\n    ],\n    \"message5\": \"%1 %2\",\n    \"args5\": [\n        {\n            \"type\": \"field_label\",\n            \"text\": \"role3\"\n        },\n        {\n            \"type\": \"input_value\",\n            \"name\": \"role3\"\n        }\n    ],\n    \"colour\": \"#19b3b0\"\n};\n\nwindow['Blockly'].Blocks['__ChatGPT_send_prompt'] = {\n    init: function() {\n        this.jsonInit(__ChatGPT_send_prompt_json);\n    }\n};\n\nwindow['Blockly'].Python['__ChatGPT_send_prompt'] = function(block) {\n    var openai_api_key = Blockly.Python.valueToCode(block, 'openai_api_key', Blockly.Python.ORDER_NONE);\nvar prompt = Blockly.Python.valueToCode(block, 'prompt', Blockly.Python.ORDER_NONE);\nvar role1 = Blockly.Python.valueToCode(block, 'role1', Blockly.Python.ORDER_NONE);\nvar role2 = Blockly.Python.valueToCode(block, 'role2', Blockly.Python.ORDER_NONE);\nvar role3 = Blockly.Python.valueToCode(block, 'role3', Blockly.Python.ORDER_NONE);\n    return `import urequests as requests\nENDPOINT='https://api.openai.com/v1/chat/completions'    \n\n# APIリクエストヘッダーを設定\nheaders = {\n    'Content-Type': 'application/json; charset=utf-8',\n    'Authorization': 'Bearer ' + ${openai_api_key}\n}\n    \n# APIリクエストデータを設定\ndata = {\n    'model': 'gpt-3.5-turbo',\n    'messages': [\n         {'role': 'system', 'content': ${role1} },\n         {'role': 'system', 'content': ${role2} },\n         {'role': 'system', 'content': ${role3} },\n         {'role': 'user', 'content': ${prompt} }\n    ]\n}\n    \n# APIリクエストを送信\njson_data = json.dumps(data)\nencoded_data = bytes(json_data, 'utf-8')\nresponse = requests.post(ENDPOINT, headers=headers, data=encoded_data)\n    \n# API応答を解析\nresponse_json = json.loads(response.text)\n` + \"\\n\";\n};\n\n// Block __ChatGPT_get_response\nvar __ChatGPT_get_response_json = {\n    \"output\": null,\n    \"message0\": \"%1\",\n    \"args0\": [\n        {\n            \"type\": \"field_label\",\n            \"text\": \"get_response\"\n        }\n    ],\n    \"colour\": \"#19b3b0\"\n};\n\nwindow['Blockly'].Blocks['__ChatGPT_get_response'] = {\n    init: function() {\n        this.jsonInit(__ChatGPT_get_response_json);\n    }\n};\n\nwindow['Blockly'].Python['__ChatGPT_get_response'] = function(block) {\n        return [`response_json['choices'][0]['message']['content'].strip()`, Blockly.Python.ORDER_CONDITIONAL]\n};\n\n","code":{"send_prompt":["window['Blockly'].Python['__ChatGPT_send_prompt'] = function(block) {\n    var openai_api_key = Blockly.Python.valueToCode(block, 'openai_api_key', Blockly.Python.ORDER_NONE);\nvar prompt = Blockly.Python.valueToCode(block, 'prompt', Blockly.Python.ORDER_NONE);\nvar role1 = Blockly.Python.valueToCode(block, 'role1', Blockly.Python.ORDER_NONE);\nvar role2 = Blockly.Python.valueToCode(block, 'role2', Blockly.Python.ORDER_NONE);\nvar role3 = Blockly.Python.valueToCode(block, 'role3', Blockly.Python.ORDER_NONE);\n    return `import urequests as requests\nENDPOINT='https://api.openai.com/v1/chat/completions'    \n\n# APIリクエストヘッダーを設定\nheaders = {\n    'Content-Type': 'application/json; charset=utf-8',\n    'Authorization': 'Bearer ' + ${openai_api_key}\n}\n    \n# APIリクエストデータを設定\ndata = {\n    'model': 'gpt-3.5-turbo',\n    'messages': [\n         {'role': 'system', 'content': ${role1} },\n         {'role': 'system', 'content': ${role2} },\n         {'role': 'system', 'content': ${role3} },\n         {'role': 'user', 'content': ${prompt} }\n    ]\n}\n    \n# APIリクエストを送信\njson_data = json.dumps(data)\nencoded_data = bytes(json_data, 'utf-8')\nresponse = requests.post(ENDPOINT, headers=headers, data=encoded_data)\n    \n# API応答を解析\nresponse_json = json.loads(response.text)\n` + \"\\n\";\n};\n\n","import urequests as requests\nENDPOINT='https://api.openai.com/v1/chat/completions'    \n\n# APIリクエストヘッダーを設定\nheaders = {\n    'Content-Type': 'application/json; charset=utf-8',\n    'Authorization': 'Bearer ' + ${openai_api_key}\n}\n    \n# APIリクエストデータを設定\ndata = {\n    'model': 'gpt-3.5-turbo',\n    'messages': [\n         {'role': 'system', 'content': ${role1} },\n         {'role': 'system', 'content': ${role2} },\n         {'role': 'system', 'content': ${role3} },\n         {'role': 'user', 'content': ${prompt} }\n    ]\n}\n    \n# APIリクエストを送信\njson_data = json.dumps(data)\nencoded_data = bytes(json_data, 'utf-8')\nresponse = requests.post(ENDPOINT, headers=headers, data=encoded_data)\n    \n# API応答を解析\nresponse_json = json.loads(response.text)\n"],"get_response":["window['Blockly'].Python['__ChatGPT_get_response'] = function(block) {\n        return [`response_json['choices'][0]['message']['content'].strip()`, Blockly.Python.ORDER_CONDITIONAL]\n};\n\n","response_json['choices'][0]['message']['content'].strip()"]}}